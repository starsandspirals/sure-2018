ggplot(D[,.(tb=mean(active_tb)),by=.(gender,acat,hiv,art)],aes(acat,tb)) + geom_point() + facet_grid(gender ~ hiv+art)
help()]
help()
help()
library(data.table)
install
clear
demo()
help.start()
q()
install.packages(ggplot2)
install.packages(ggplot)
install.packages("ggplot2")
library(ggplot2)
library("ggplot2")
setwd('updateandsomemoredata')
## read in data
D <- fread('person-output-0.csv')
install.packages(data.table)
install.packages("data.table")
library(data.table)
names(D)
D[,acat:=cut(age,breaks=c(0,5,15,25,35,45,55,65,Inf),include.lowest = TRUE)]
D[,acat2:=cut(age,breaks=c(0,17,25,45,Inf),include.lowest = TRUE)]
D[,sexage:=paste0(gender,':',acat)]
tmp <- D[,.N,by=.(household_size,sexage)]
tmp
ggplot(D,aes(x=acat)) + geom_bar()
## comparing household size distribution
DM <- dcast(tmp[,.(N,sexage,hhsize=household_size)],sexage~hhsize,value.var='N')
DM
dm <- as.matrix(DM[,-1,with=FALSE])
print(sum(dm,na.rm=TRUE))
(dm <- dm/sum(dm,na.rm=TRUE))
H <- fread('../histo.csv',header=TRUE)
h <- as.matrix(H[,-1,with=FALSE])
print(sum(h))
(h <- h/sum(h))
HM <- melt(H)
names(HM)[2:3] <- c('hhsize','hcount')
str(HM)
HM$hhsize <- as.integer(as.character(HM$hhsize))
## via shape (not robust)
qplot(x=c(dm),y=c(h),geom='point') + coord_fixed() + geom_abline(intercept=0,slope=1,col=2)
ggsave('hh1.pdf')
HM
names(tmp) <- c('hhsize','sexage','hcountS')
str(tmp)
## via merge in case cols different
tmp <- merge(tmp,HM,by=c('hhsize','sexage'),all=TRUE)
tmp[,hcountn:=hcount/sum(hcount,na.rm=TRUE)]
tmp[,hcountSn:=hcountS/sum(hcountS,na.rm=TRUE)]
library(data.table)
library(ggplot2)
H <- fread('../histo.csv',header=TRUE)
H <- fread('histo.csv',header=TRUE)
h <- as.matrix(H[,-1,with=FALSE])
print(sum(h))
(h <- h/sum(h))
